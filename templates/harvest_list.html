{% extends "base.html" %}
{% block content %}
<h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß (‡∏£‡∏≤‡∏¢‡∏ï‡πâ‡∏ô)</h2>
<p>
  <a class="btn" href="{{ url_for('harvest_new') }}">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</a>
  <a class="btn" href="{{ url_for('harvest_export') }}">üì§ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</a>
</p>
<form action="{{ url_for('harvest_import') }}" method="post" enctype="multipart/form-data" style="margin-bottom:15px;">
  <div class="row">
    <label>üì• ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ CSV:</label>
    <input type="file" name="file" accept=".csv" required style="margin-right:10px;">
    <button class="btn" type="submit">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</button>
    <small style="margin-left:10px;color:#666;">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: date,palm_code,bunch_count,remarks</small>
  </div>
</form>
<table class="table">
  <thead>
    <tr>
      <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏ï‡πâ‡∏ô‡∏õ‡∏≤‡∏•‡πå‡∏°</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏∞‡∏•‡∏≤‡∏¢</th><th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
    </tr>
  </thead>
  <tbody>
    {% for id, d, code, count, remarks in rows %}
    <tr>
      <td>{{ (d.day|string).zfill(2) }}/{{ (d.month|string).zfill(2) }}/{{ d.year + 543 }}</td>
      <td>{{ code }}</td>
      <td style="text-align:right">{{ count }}</td>
      <td>{{ remarks or "" }}</td>
      <td>
        <a class="btn" href="{{ url_for('harvest_edit', id=id) }}">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</a>
        <form method="post" action="{{ url_for('harvest_delete', id=id) }}" style="display:inline;" onsubmit="return confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö?');">
          <button class="btn" type="submit" style="background:#e74c3c;">‡∏•‡∏ö</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
